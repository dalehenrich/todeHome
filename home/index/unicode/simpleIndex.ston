TDScriptLeafNode{#name:'simpleIndex',#contents:'[ :topez :objIn :tokens :windowId | \n| tree population populationIndexSpec query halt create result collator |\ncreate := halt := false.\ntokens size > 1\n  ifTrue: [ \n    halt := (tokens at: 2) = \'halt\'.\n    create := (tokens at: 2) = \'create\' ].\ntree := (topez lookup: \'/home/index/family\') dotSelfObject.\npopulation := tree population.\ncollator := IcuCollator forLocaleNamed: \'el_GR\'.\npopulationIndexSpec := GsIndexSpec new\n  unicodeIndex: \'each.unicodeField\' collator: collator;\n  yourself.\nIndexManager current removeAllIncompleteIndexesOn: population.\n[ \ncreate\n  ifTrue: [ populationIndexSpec createIndexesOn: population ].\nresult := halt\n  ifTrue: [ \n    population halt.\n    population ]\n  ifFalse: [ \n    | sorted sorted_ASCII expected options unicodeField |\n    options := GsQuery defaultQueryOptions + GsQueryOptions cacheQueryResult.\n    unicodeField := \'\u00CE\u009A\u00CF\u0085\u00CF\u0081\u00CE\u00B9\u00CE\u00B1\u00CE\u00BA\u00CE\u00AE\' asUnicodeString.\n    sorted := population asArray\n      sorted: [ :a :b | (a unicodeField compareTo: b unicodeField collator: collator) <= 0 ].\n    sorted_ASCII := population asArray\n      sorted: [ :a :b | a stringField <= b stringField ].\n    expected := population\n      select: [ :each | (each unicodeField compareTo: unicodeField collator: collator) = 0 ].\n    query := (GsQuery fromString: \'each.unicodeField = string\' options: options)\n      bind: \'string\' to: unicodeField;\n      on: population collator: collator;\n      yourself.\n    result := {(sorted collect: [ :each | each unicodeField ]).\n    (expected collect: [ :each | each unicodeField ]).\n    (query collect: [ :each | each unicodeField ]).\n\t\t\t(query queryResult collect: [ :each | each unicodeField ])} ] ]\n  ensure: [ IndexManager current removeAllIncompleteIndexesOn: population ].\ntrue\n  ifTrue: [ populationIndexSpec removeIndexesFrom: population ].\nresult ]',#creationTime:DateAndTime['2013-12-06T17:02:00.63954091072083-08:00'],#modificationTime:@2}