TDScriptLeafNode{#name:'simpleIndex',#contents:'[ :topez :objIn :tokens :windowId | \n| tree population populationIndexSpec query halt create result |\n\"simple enumerated index\"\ncreate := halt := false.\ntokens size > 1\n  ifTrue: [ \n    halt := (tokens at: 2) = \'halt\'.\n    create := (tokens at: 2) = \'create\' ].\ntree := (topez lookup: \'/home/index/family\') dotSelfObject.\npopulation := tree population.\npopulationIndexSpec := GsIndexSpec new\n  equalityIndex: \'each.firstName|lastName\' lastElementClass: String;\n  yourself.\nIndexManager current removeAllIncompleteIndexesOn: population.\n[ \ncreate\n  ifTrue: [ populationIndexSpec createIndexesOn: population ].\nresult := halt\n  ifTrue: [ \n    population halt.\n    population ]\n  ifFalse: [ \n    | expected options name |\n    options := GsQuery defaultQueryOptions + GsQueryOptions cacheQueryResult.\n\t\t\tname := \'Jessie\'.\n    expected := (GsQuery\n      fromString: \'(each.firstName = name) | (each.lastName = name)\'\n      options: options)\n      on: population;\n      bind: \'name\' to: name;\n      yourself.\n    query := (GsQuery\n      fromString: \'each.firstName|lastName = name\'\n      options: options)\n      bind: \'name\' to: name;\n      on: population;\n      yourself.\n    expected size = query size\n      ifFalse: [ nil error: \'size mismatch\' ].\n    expected\n      do: [ :each | \n        (query includes: each)\n          ifFalse: [ nil error: \'contents mismatch\' ] ].\n    query queryResult ] ]\n  ensure: [ IndexManager current removeAllIncompleteIndexesOn: population ].\ntrue\n  ifTrue: [ populationIndexSpec removeIndexesFrom: population ].\nresult ]',#creationTime:DateAndTime['2013-12-06T17:02:00.40302109718323-08:00'],#modificationTime:@2}